<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>I N S T a L L | AFLplusplus</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">

<meta property="og:title" content="I N S T a L L | AFLplusplus" />
<meta name="twitter:title" content="I N S T a L L | AFLplusplus" />
<meta itemprop="name" content="I N S T a L L | AFLplusplus" />
<meta name="application-name" content="I N S T a L L | AFLplusplus" />
<meta property="og:site_name" content="AFLplusplus" />

<meta name="description" content="The AFLplusplus website" />
<meta itemprop="description" content="The AFLplusplus website" />
<meta property="og:description" content="The AFLplusplus website" />
<meta name="twitter:description" content="The AFLplusplus website" />

<base href="https://aflplus.plus/docs/install/">
<link rel="canonical" href="https://aflplus.plus/docs/install/" itemprop="url" /> 
<meta name="url" content="https://aflplus.plus/docs/install/" />
<meta name="twitter:url" content="https://aflplus.plus/docs/install/" /> 
<meta property="og:url" content="https://aflplus.plus/docs/install/" />

 
  <meta itemprop="image" content="https://aflplus.plus/ogimage.png" />
  <meta property="og:image" content="https://aflplus.plus/ogimage.png" /> 
  <meta name="twitter:image" content="https://aflplus.plus/ogimage.png" />
  <meta name="twitter:image:src" content="https://aflplus.plus/ogimage.png" /> 



<link rel="stylesheet" href="/book.min.5f6934428064085210d9b92c20af9b09c67cef71f93fa65ebbc5af315512573d.css" integrity="sha256-X2k0QoBkCFIQ2bksIK&#43;bCcZ873H5P6Zeu8WvMVUSVz0=">


<script defer src="/en.search.min.60dd47b31fb4278481711e71c795f66f7a9e6358d1a8c9672fbef99dd51a6747.js" integrity="sha256-YN1Hsx&#43;0J4SBcR5xx5X2b3qeY1jRqMlnL775ndUaZ0c="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/logo_256x256.png" alt="Logo" /><span>AFLplusplus</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





  <ul>
<li><strong>Site map</strong>
<ul>
<li><a href="/features/">Features</a></li>
<li><a href="/building/">Build &amp; Install</a></li>
<li><a href="/docs/tutorials/">Tutorials</a></li>
<li><a href="/docs/">Documentation</a></li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li><strong>Downloads</strong>
<ul>
<li><a href="https://github.com/AFLplusplus/AFLplusplus/releases/tag/2.65c">Release 2.65c</a>
</li>
<li><a href="https://github.com/AFLplusplus/AFLplusplus/releases">All releases</a></li>
<li><a href="https://github.com/AFLplusplus/AFLplusplus/archive/master.zip">Current devel</a></li>
<li><a href="https://raw.githubusercontent.com/AFLplusplus/AFLplusplus/master/docs/COPYING">License</a></li>
</ul>
</li>
<li><strong>Links</strong>
<ul>
<li><a href="https://github.com/AFLplusplus/AFLplusplus">Repo (GitHub)</a></li>
<li><a href="https://groups.google.com/group/afl-users">Mailing list</a></li>
</ul>
</li>
</ul>





</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>I N S T a L L</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-linux-on-x86">1) Linux on x86</a></li>
    <li><a href="#openbsd-freebsd-netbsd-on-x86">OpenBSD, FreeBSD, NetBSD on x86</a></li>
    <li><a href="#3-macos-x-on-x86">3. MacOS X on x86</a></li>
    <li><a href="#4-linux-or-bsd-on-non-x86-systems">4. Linux or *BSD on non-x86 systems</a></li>
    <li><a href="#5-solaris-on-x86">5. Solaris on x86</a></li>
    <li><a href="#6-everything-else">6. Everything else</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
<article class="markdown"><h1 id="installation-instructions">Installation instructions</h1>
<p>This document provides basic installation instructions and discusses known
issues for a variety of platforms. See README.md for the general instruction
manual.</p>
<h2 id="1-linux-on-x86">1) Linux on x86</h2>
<hr>
<p>This platform is expected to work well. Compile the program with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make
</code></pre></div><p>You can start using the fuzzer without installation, but it is also possible to
install it with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make install
</code></pre></div><p>There are no special dependencies to speak of; you will need GNU make and a
working compiler (gcc or clang). Some of the optional scripts bundled with the
program may depend on bash, gdb, and similar basic tools.</p>
<p>If you are using clang, please review llvm_mode/README.md; the LLVM
integration mode can offer substantial performance gains compared to the
traditional approach.</p>
<p>You may have to change several settings to get optimal results (most notably,
disable crash reporting utilities and switch to a different CPU governor), but
afl-fuzz will guide you through that if necessary.</p>
<h2 id="openbsd-freebsd-netbsd-on-x86">OpenBSD, FreeBSD, NetBSD on x86</h2>
<p>Similarly to Linux, these platforms are expected to work well and are
regularly tested. Compile everything with GNU make:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gmake
</code></pre></div><p>Note that BSD make will <em>not</em> work; if you do not have gmake on your system,
please install it first. As on Linux, you can use the fuzzer itself without
installation, or install it with:</p>
<pre><code>gmake install
</code></pre><p>Keep in mind that if you are using csh as your shell, the syntax of some of the
shell commands given in the README.md and other docs will be different.</p>
<p>The <code>llvm_mode</code> requires a dynamically linked, fully-operational installation of
clang. At least on FreeBSD, the clang binaries are static and do not include
some of the essential tools, so if you want to make it work, you may need to
follow the instructions in llvm_mode/README.md.</p>
<p>Beyond that, everything should work as advertised.</p>
<p>The QEMU mode is currently supported only on Linux. I think it&rsquo;s just a QEMU
problem, I couldn&rsquo;t get a vanilla copy of user-mode emulation support working
correctly on BSD at all.</p>
<h2 id="3-macos-x-on-x86">3. MacOS X on x86</h2>
<p>MacOS X should work, but there are some gotchas due to the idiosyncrasies of
the platform. On top of this, I have limited release testing capabilities
and depend mostly on user feedback.</p>
<p>To build AFL, install Xcode and follow the general instructions for Linux.</p>
<p>The Xcode &lsquo;gcc&rsquo; tool is just a wrapper for clang, so be sure to use afl-clang
to compile any instrumented binaries; afl-gcc will fail unless you have GCC
installed from another source (in which case, please specify <code>AFL_CC</code> and
<code>AFL_CXX</code> to point to the &ldquo;real&rdquo; GCC binaries).</p>
<p>Only 64-bit compilation will work on the platform; porting the 32-bit
instrumentation would require a fair amount of work due to the way OS X
handles relocations, and today, virtually all MacOS X boxes are 64-bit.</p>
<p>The crash reporting daemon that comes by default with MacOS X will cause
problems with fuzzing. You need to turn it off by following the instructions
provided here: <a href="http://goo.gl/CCcd5u">http://goo.gl/CCcd5u</a></p>
<p>The <code>fork()</code> semantics on OS X are a bit unusual compared to other unix systems
and definitely don&rsquo;t look POSIX-compliant. This means two things:</p>
<ul>
<li>Fuzzing will be probably slower than on Linux. In fact, some folks report
considerable performance gains by running the jobs inside a Linux VM on
MacOS X.</li>
<li>Some non-portable, platform-specific code may be incompatible with the
AFL forkserver. If you run into any problems, set <code>AFL_NO_FORKSRV=1</code> in the
environment before starting afl-fuzz.</li>
</ul>
<p>User emulation mode of QEMU does not appear to be supported on MacOS X, so
black-box instrumentation mode (<code>-Q</code>) will not work.</p>
<p>The llvm_mode requires a fully-operational installation of clang. The one that
comes with Xcode is missing some of the essential headers and helper tools.
See llvm_mode/README.md for advice on how to build the compiler from scratch.</p>
<h2 id="4-linux-or-bsd-on-non-x86-systems">4. Linux or *BSD on non-x86 systems</h2>
<p>Standard build will fail on non-x86 systems, but you should be able to
leverage two other options:</p>
<ul>
<li>The LLVM mode (see llvm_mode/README.md), which does not rely on
x86-specific assembly shims. It&rsquo;s fast and robust, but requires a
complete installation of clang.</li>
<li>The QEMU mode (see qemu_mode/README.md), which can be also used for
fuzzing cross-platform binaries. It&rsquo;s slower and more fragile, but
can be used even when you don&rsquo;t have the source for the tested app.</li>
</ul>
<p>If you&rsquo;re not sure what you need, you need the LLVM mode. To get it, try:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">AFL_NO_X86<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> gmake <span style="color:#f92672">&amp;&amp;</span> gmake -C llvm_mode
</code></pre></div><p>&hellip;and compile your target program with afl-clang-fast or afl-clang-fast++
instead of the traditional afl-gcc or afl-clang wrappers.</p>
<h2 id="5-solaris-on-x86">5. Solaris on x86</h2>
<p>The fuzzer reportedly works on Solaris, but I have not tested this first-hand,
and the user base is fairly small, so I don&rsquo;t have a lot of feedback.</p>
<p>To get the ball rolling, you will need to use GNU make and GCC or clang. I&rsquo;m
being told that the stock version of GCC that comes with the platform does not
work properly due to its reliance on a hardcoded location for &lsquo;as&rsquo; (completely
ignoring the <code>-B</code> parameter or <code>$PATH</code>).</p>
<p>To fix this, you may want to build stock GCC from the source, like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./configure --prefix<span style="color:#f92672">=</span>$HOME/gcc --with-gnu-as --with-gnu-ld <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --with-gmp-include<span style="color:#f92672">=</span>/usr/include/gmp --with-mpfr-include<span style="color:#f92672">=</span>/usr/include/mpfr
make
sudo make install
</code></pre></div><p>Do <em>not</em> specify <code>--with-as=/usr/gnu/bin/as</code> - this will produce a GCC binary that
ignores the <code>-B</code> flag and you will be back to square one.</p>
<p>Note that Solaris reportedly comes with crash reporting enabled, which causes
problems with crashes being misinterpreted as hangs, similarly to the gotchas
for Linux and MacOS X. AFL does not auto-detect crash reporting on this
particular platform, but you may need to run the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">coreadm -d global -d global-setid -d process -d proc-setid <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -d kzone -d log
</code></pre></div><p>User emulation mode of QEMU is not available on Solaris, so black-box
instrumentation mode (<code>-Q</code>) will not work.</p>
<h2 id="6-everything-else">6. Everything else</h2>
<p>You&rsquo;re on your own. On POSIX-compliant systems, you may be able to compile and
run the fuzzer; and the LLVM mode may offer a way to instrument non-x86 code.</p>
<p>The fuzzer will run on Windows in WSL only. It will not work under Cygwin on in the normal Windows world. It
could be ported to the latter platform fairly easily, but it&rsquo;s a pretty bad
idea, because Cygwin is extremely slow. It makes much more sense to use
VirtualBox or so to run a hardware-accelerated Linux VM; it will run around
20x faster or so. If you have a <em>really</em> compelling use case for Cygwin, let
me know.</p>
<p>Although Android on x86 should theoretically work, the stock kernel may have
SHM support compiled out, and if so, you may have to address that issue first.
It&rsquo;s possible that all you need is this workaround:</p>
<p><a href="https://github.com/pelya/android-shmem">https://github.com/pelya/android-shmem</a></p>
<p>Joshua J. Drake notes that the Android linker adds a shim that automatically
intercepts <code>SIGSEGV</code> and related signals. To fix this issue and be able to see
crashes, you need to put this at the beginning of the fuzzed program:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">  signal<span style="color:#f92672">(</span>SIGILL, SIG_DFL<span style="color:#f92672">)</span>;
  signal<span style="color:#f92672">(</span>SIGABRT, SIG_DFL<span style="color:#f92672">)</span>;
  signal<span style="color:#f92672">(</span>SIGBUS, SIG_DFL<span style="color:#f92672">)</span>;
  signal<span style="color:#f92672">(</span>SIGFPE, SIG_DFL<span style="color:#f92672">)</span>;
  signal<span style="color:#f92672">(</span>SIGSEGV, SIG_DFL<span style="color:#f92672">)</span>;
</code></pre></div><p>You may need to <code>#include &lt;signal.h&gt;</code> first.</p>
</article>
 

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
  
  <div class="book-comments">

</div>
  
 
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-linux-on-x86">1) Linux on x86</a></li>
    <li><a href="#openbsd-freebsd-netbsd-on-x86">OpenBSD, FreeBSD, NetBSD on x86</a></li>
    <li><a href="#3-macos-x-on-x86">3. MacOS X on x86</a></li>
    <li><a href="#4-linux-or-bsd-on-non-x86-systems">4. Linux or *BSD on non-x86 systems</a></li>
    <li><a href="#5-solaris-on-x86">5. Solaris on x86</a></li>
    <li><a href="#6-everything-else">6. Everything else</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












